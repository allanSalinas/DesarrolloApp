┌────────────────────────────────────────────────────────────────────────┐
│                            VIEW LAYER                                  │
│                               (UI)                                     │
├────────────────────────────────────────────────────────────────────────┤
│                            Main.kt                                     │
│                                                                        │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │  Función principal: runBlocking {}                              │  │
│  │  - Muestra catálogo                                              │  │
│  │  - Captura selecciones                                           │  │
│  │  - Llama a ViewModel                                             │  │
│  │  - Muestra resultados                                            │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                        │
│  Observa: catalogo, estadoPrestamo, mensajeError, reporte             │
└───────────────────────────────┬────────────────────────────────────────┘
                                │
                                │ Llama métodos ViewModel
                                │ Observa States
                                │
┌───────────────────────────────▼────────────────────────────────────────┐
│                         VIEWMODEL LAYER                                │
│                           (Lógica de Presentación)                     │
├────────────────────────────────────────────────────────────────────────┤
│                      BibliotecaViewModel                               │
│                                                                        │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │
│  │   States        │  │   Métodos       │  │   Corrutinas    │        │
│  │                 │  │                 │  │                 │        │
│  │ • catalogo      │  │ • solicitar-    │  │ • viewModelScope│        │
│  │ • estadoPrestamo│  │   Prestamo()    │  │ • launch{}      │        │
│  │ • mensajeError  │  │ • generar-      │  │ • async{}       │        │
│  │ • reporte       │  │   Reporte()     │  │                 │        │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘        │
│                                                                        │
│  Procesa datos → Formatea → Gestiona estado → Notifica cambios        │
└───────────────────────────────┬────────────────────────────────────────┘
                                │
                                │ Usa Repository
                                │
┌───────────────────────────────▼────────────────────────────────────────┐
│                          MODEL LAYER                                   │
│                      (Lógica de Negocio)                               │
├────────────────────────────────────────────────────────────────────────┤
│                     BibliotecaRepository                               │
│                                                                        │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │
│  │   Datos         │  │   Operaciones   │  │   Validaciones  │        │
│  │                 │  │                 │  │                 │        │
│  │ • catalogoLibros│  │ • obtener-      │  │ • puedePrestarse│        │
│  │ • prestamos     │  │   Catalogo()    │  │ • precioVálido  │        │
│  │                 │  │ • procesar-     │  │ • díasVálidos   │        │
│  │                 │  │   Prestamo()    │  │                 │        │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘        │
│                                                                        │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                         ENTIDADES                                │  │
│  │  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    │  │
│  │  │  Libro   │◄───│LibroFísico   │  Usuario  │    │ Prestamo │    │  │
│  │  │          │    │LibroDigital  │          │    │          │    │  │
│  │  └──────────┘    └──────────┘    └──────────┘    └──────────┘    │  │
│  │         │                                                       │  │
│  │         └──────────┐                                            │  │
│  │  ┌──────────┐      │                                            │  │
│  │  │Estado-   │      │                                            │  │
│  │  │Prestamo  │──────┘                                            │  │
│  │  └──────────┘                                                    │  │
│  └──────────────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────────────┘